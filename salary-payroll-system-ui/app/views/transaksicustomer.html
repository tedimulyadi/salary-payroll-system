<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Transaksi Customer
        <small>Control panel</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Transaksi Customer</li>
    </ol>
</section>

<!-- Main content -->
<section class="content" >
    <div class="form-inline" align = "right" style="margin-bottom:1em">
        <div class="form-group col-lg-1" style="padding-left:0px">
            <button class="btn btn-success" ng-click="reloadForm()">Reload Form </button>
        </div>
        <div class="form-group col-lg-offset-3 col-lg-4">
            <select class="form-control" name="searchBy" id = "searchBy" ng-model="searchCategory">
                <option value="" disabled selected>Search By :</option>
                <option>Name</option>
                <option>Email</option>
                <option>Mobile</option>
                <option>Address</option>
            </select>
        </div>
        <!--</div>-->
        <!--<div class="form-inline">-->
        <!--<div class="form-group col-lg-4">-->
        <div class="input-group">
            <input type="text" class="form-control" placeholder="Search" name="srch-term" id="srch-term" ng-model="search">
            <span class="input-group-btn">
                <button class="btn btn-default" type="button" ng-click="searchBy()"><i class="glyphicon glyphicon-search"></i></button>
            </span>
        </div>
        <!--</div>-->
    </div>

    <div style="height: 40%">
        <div class="panel panel-default">
            <div class="panel-heading">
                Customer
            </div>
            <div class="panel-body" style="margin:5px;height:275px;overflow: auto;">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>
                                Name
                            </th>
                            <th>
                                Email
                            </th>
                            <th>
                                Mobile
                            </th>
                            <th>
                                Address
                            </th>
                            <th class="col-xs-1">
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="customer in listCustomer.content">    
                            <td>{{customer.name}}</td>
                            <td>{{customer.email}}</td>
                            <td>{{customer.mobile}}</td>
                            <td>{{customer.address}}</td>
                            <td class="col-xs-1">
                                <a class="glyphicon glyphicon-edit" style="cursor:pointer" ng-click="getCustomerTransaction(customer)"></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="panel-footer">
                <pagination total-items="totalItem" ng-model="currentPage" items-per-page = "maxSize"
                            max-size="maxSize" class="pagination-sm" boundary-links="true" rotate="false" ng-change="initCustomerList(currentPage - 1)"></pagination>
            </div>
        </div>
    </div>

    <div style="height: 60%">
        <div class="panel panel-default" >
            <div class="panel-heading">
                <b>Customer Transaction : {{currentTransaction.customer.name}}</b>
            </div>
            <div id = "tableTransaction" class="panel-body" style="margin:5px;height:250px;overflow: auto;">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>
                                Transaction Time
                            </th>
                            <th>
                                Balance Type
                            </th>
                            <th>
                                Amount
                            </th>
                            <th>
                                Description
                            </th>
                            <th class="col-xs-1">
                                <button type="button" class="btn-right btn btn-default btn-sm btn-block" ng-click = "showAddCustomerTransaction()" ng-disabled="isCustomerSelected()">
                                    <span class="glyphicon glyphicon-plus-sign"></span>
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="transaction in listTransactionCustomer">
                            <td>{{transaction.transactionTime| date:'yyyy-MM-dd HH:mm:ss'}}</td>
                            <td>{{transaction.balanceType}}</td>
                            <td>{{transaction.totalAmount}}</td>
                            <td>{{transaction.description}}</td>
                            <td class="col-xs-1">
                                <div align="center">
                                    <a class="glyphicon glyphicon-th-list" style="cursor:pointer" ng-click="showTransactionDetail(transaction)"></a> &nbsp;&nbsp;
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="modal fade" id="inputCustomerTransaction" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog">
			
            <div class="modal-content">
				<form name="formTransaksiCustomer" id="formTransaksiCustomer" >
					<div class="modal-header">
						<button type="button" class="close"data-dismiss="modal">&times;</button>
						<h4 class="modal-title" id="myModalLabel">Add Customer Transaction</h4>
					</div>

					<div class="modal-body">
						<div class="form-horizontal">
							<div class="form-group" ng-class ="{'has-error':formTransaksiCustomer.transactionTime.$invalid, 'has-success':formTransaksiCustomer.transactionTime.$valid}">
								<div class="col-sm-4">
									<label for="transactionTime" class="control-label">Transaction Date</label>
								</div>
								<div class="col-sm-8">
									<div class="input-group">
										<input type="text" 
											   name="transactionTime"
											   id="transactionTime"
											   class="form-control" 
											   ng-model="currentTransaction.transactionTime"
											   datepicker-popup="dd MMMM yyyy" 
											   is-open="openedTransactionDate" 
											   close-text="Close" 
											   required/>
										<span class="input-group-btn">
											<button 
												class="btn btn-default" 
												ng-click="openTransactionDate($event)">
												<i class="glyphicon glyphicon-calendar"></i>
											</button>
										</span>
									</div>
									<span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiCustomer.transactionTime.$error.required">This Field is Required</span>
								</div>
							</div>
							<div class="form-group" ng-class ="{'has-error':formTransaksiCustomer.description.$invalid, 'has-success':formTransaksiCustomer.description.$valid}">
								<div class="col-sm-4">
									<label for="description" class="control-label">Description</label>
								</div>
								<div class="col-sm-8">
									<input name="description" type="text" class="form-control" id="description" ng-model="currentTransaction.description" required/>
									<span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiCustomer.description.$error.required">This Field is Required</span>
								</div>
							</div>
						</div>
						<div>
							<table class='table table-hover' style="border:1px solid #D8D8D8;">
								<thead align="left">
									<tr>
										<td><b>Item Name</b></td>
										<td><b>Quantity</b></td>
										<td><b>Unit Price</b></td>
										<td class="col-xs-1">
											<button type="button" class="btn-right btn btn-default btn-sm btn-block" ng-click = "addContentDetail()">
												<span class="glyphicon glyphicon-plus-sign"></span>
											</button>
										</td>
									</tr>
								</thead>
								<tbody >
									<tr ng-repeat="x in contentDetail" align="left">
										<td>
											<div id="div-{{x.itemNameModel}}" class="form-group">
												<input id="{{x.itemNameModel}}" name="{{x.itemNameModel}}" type="text" ng-change="checkRequiredDetailTable(x.itemNameModel)" class="form-control" ng-model ='detail[x.itemNameModel]' required/>
											</div>
										</td>
										<td>
											<div id="div-{{x.quantityModel}}" class="form-group">
												<input ng-pattern = "onlyNumbers" id="{{x.quantityModel}}" name="{{x.quantityModel}}" type="text" ng-change="checkRequiredDetailTable(x.quantityModel)" class="form-control" ng-model ='detail[x.quantityModel]' required/>
											</div>
										</td>
										<td>
											<div id='div-{{x.unitPriceModel}}' class="form-group">
												<input ng-pattern = "onlyNumbers" id='{{x.unitPriceModel}}' name="{{x.unitPriceModel}}" type="text" ng-change="checkRequiredDetailTable(x.unitPriceModel)" class="form-control" ng-model ='detail[x.unitPriceModel]' required/>
											</div>
										</td>
										<td class="col-xs-1">
											<button type="button" class="btn-right btn btn-default btn-sm btn-block" ng-click = "ramoveDetail($index,x)">
												<span class="glyphicon glyphicon-remove"></span>
											</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="modal-footer">
						<div class="form-horizontal">
							<div class="row">
								<!--<div class="col-md-6">
									<span>Total :</span>&nbsp;<span><b>{{getTotalAmount}}</b></span>
								</div>-->
								<div style="float:right" class="col-md-12">
									<button class="btn btn-primary" ng-disabled="formTransaksiCustomer.$invalid" ng-click ="saveCustomerTansaction()">Save</button>
									<button class="btn btn-default" data-dismiss="modal">Cancel</button>
								</div>
							</div>
						</div>
					</div>
				</form> 	
            </div>
        </div>
    </div>

    <div class="modal fade" id="inputCustomerDetailTransaction" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <button type="button" class="close"data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Add Customer Detail Transaction</h4>
                </div>

                <div class="modal-body">
                    <form name="formTransaksiDetailCustomer" id="formTransaksiDetailCustomer" >
                        <div class="form-horizontal">
                            <div class="form-group" ng-class ="{'has-error':formTransaksiDetailCustomer.itemName.$invalid, 'has-success':formTransaksiDetailCustomer.itemName.$valid}">
                                <div class="col-sm-4">
                                    <label for="itemName" class="control-label">Item Name</label>
                                </div>
                                <div class="col-sm-8">
                                    <input name="itemName" type="text" class="form-control" id="itemName" ng-model="currentTransactionDetail.itemName" required/>
                                    <span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiDetailCustomer.itemName.$error.required">This Field is Required</span>
                                </div>
                            </div>
                            <div class="form-group" ng-class ="{'has-error':formTransaksiDetailCustomer.quantity.$invalid, 'has-success':formTransaksiDetailCustomer.quantity.$valid}">
                                <div class="col-sm-4">
                                    <label for="quantity" class="control-label">Quantity</label>
                                </div>
                                <div class="col-sm-8">
                                    <input name="quantity" type="text" class="form-control" id="quantity" ng-model="currentTransactionDetail.quantity" ng-pattern = "onlyNumbers" required/>
                                    <span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiDetailCustomer.quantity.$error.required">This Field is Required</span>
                                    <span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiDetailCustomer.quantity.$error.pattern">Invalid Number</span>
                                </div>
                            </div>
                            <div class="form-group" ng-class ="{'has-error':formTransaksiDetailCustomer.unitPrice.$invalid, 'has-success':formTransaksiDetailCustomer.unitPrice.$valid}">
                                <div class="col-sm-4">
                                    <label for="unitPrice" class="control-label">Unit Price</label>
                                </div>
                                <div class="col-sm-8">
                                    <input name="unitPrice" type="text" class="form-control" id="unitPrice" ng-model="currentTransactionDetail.unitPrice" ng-pattern = "onlyNumbers" required/>
                                    <span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiDetailCustomer.unitPrice.$error.required">This Field is Required</span>
                                    <span style="float:right; color:white" class="help-block label label-danger" ng-show="formTransaksiDetailCustomer.unitPrice.$error.pattern">Invalid Number</span>
                                </div>
                            </div>
                            <div align="right">
                                <button class="btn btn-primary" ng-disabled="formTransaksiDetailCustomer.$invalid" ng-click ="addCustomerTansactionDetail()">Save</button>
                                <button class="btn btn-default" data-dismiss="modal">Cancel</button>
                            </div>
                        </div>
                    </form> 
                </div>

            </div>
        </div>
    </div>
</section>
